<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>mvtview</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.45.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.45.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>
<div id='map'></div>
<script>
    mapboxgl.accessToken = '<%= params.accessToken %>';
    var map = new mapboxgl.Map({
      container: 'map', // container id
      style: 'mapbox://styles/mapsam/cji6k02670ie82sr09n2r6vsi',
      zoom: 7,
      center: [-122.359794, 47.943776]
    });

    map.showTileBoundaries = true;

    map.on('load', function() {
      map.addSource('view-tile', {
        "type": "vector",
        "tiles": ["http://localhost:3000/{z}/{x}/{y}.mvt"],
        "minzoom": 0,
        "maxzoom": 22
      });

      <% style.layers.forEach(function(layer) { %>
        map.addLayer({
          'id': '<%= layer.id %>',
          'type': '<%= layer.type %>',
          'source': 'view-tile',
          'source-layer': '<%= layer.id %>',
          'layout': <%- JSON.stringify(layer.layout) %>,
          'paint': <%- JSON.stringify(layer.paint) %>
        });
      <% }); %>
    });

</script>

</body>
</html>
